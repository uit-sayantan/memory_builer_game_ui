<div class="game-screen" (click)="$event.preventDefault()">
  <!-- Audio Elements -->
  <audio #correctAudioRef preload="auto">
    <source src="audio/correct.mp3" type="audio/mpeg">
  </audio>
  <audio #wrongAudioRef preload="auto">
    <source src="audio/wrong.mp3" type="audio/mpeg">
  </audio>

  <app-header
    [username]="state.username"
    [accuracy]="accuracy"
    [timeElapsed]="timeElapsed"
  ></app-header>
  <div class="bubbles-container">
    <app-bubble
      *ngFor="let bubble of bubbles"
      [color]="bubble.color"
      [size]="bubble.size"
      [id]="bubble.id"
      [top]="bubble.top"
      [left]="bubble.left"
      [class.burst-animation]="burstingBubbleId === bubble.id"
      (click)="onBubbleClick(bubble.id)"
    ></app-bubble>

    <!-- Burst Ring Effects -->
    <!-- <div 
      *ngFor="let ring of burstRings"
      class="burst-ring"
      [style.left.%]="ring.left"
      [style.top.%]="ring.top"
      [style.width.px]="ring.size"
      [style.height.px]="ring.size"
      [style.--ring-delay]="ring.delay + 'ms'"
    ></div> -->

    <!-- Burst Particles (Stars/Bubbles) -->
    <div 
      *ngFor="let particle of particles"
      class="burst-particle"
      [style.left.%]="particle.left"
      [style.top.%]="particle.top"
      [style.--angle]="particle.angle + 'rad'"
      [style.--velocity]="particle.velocity + 'px'"
      [style.--duration]="particle.duration + 'ms'"
      [style.font-size]="(2 * particle.size) + 'rem'"
    >
      {{ particle.particle }}
    </div>

    <!-- Floating Congratulations Text with Letter Scatter -->
    <div 
      *ngIf="showCongratulations" 
      class="floating-celebration"
      [style.left.%]="celebrationPosition.left"
      [style.top.%]="celebrationPosition.top"
    >
      <!-- <span class="celebration-text" [style.animation-name]="celebrationAnimation">
        <span class="letter" style="--letter-delay: 0ms">ðŸŽ‰</span>
        <span class="letter" style="--letter-delay: 60ms">C</span>
        <span class="letter" style="--letter-delay: 120ms">o</span>
        <span class="letter" style="--letter-delay: 180ms">r</span>
        <span class="letter" style="--letter-delay: 240ms">r</span>
        <span class="letter" style="--letter-delay: 300ms">e</span>
        <span class="letter" style="--letter-delay: 360ms">c</span>
        <span class="letter" style="--letter-delay: 420ms">t</span>
        <span class="letter" style="--letter-delay: 480ms">!</span>
        <span class="letter" style="--letter-delay: 540ms">ðŸŽ‰</span>
      </span> -->
    </div>

    <!-- Wrong Answer Toast with Letter Scatter -->
    <div class="wrong-toast" *ngIf="showWrongAnswer">
      <span class="sad-face" style="--delay: 0ms">ðŸ˜ž</span>
      <span class="sad-face" style="--delay: 200ms">ðŸ˜­</span>
      <span class="sad-face" style="--delay: 300ms">ðŸ˜”</span>
    </div>

    <app-question-modal
      *ngIf="showQuestionModal"
      [question]="currentQuestion"
      [timeLimit]="currentQuestion.available_time_limit"
      (answerSelected)="onAnswerSelected($event)"
      (skipQuestion)="onSkipQuestion()"
      (remainingTimeUpdate)="calculateTimeElapsed($event)"
    ></app-question-modal>
  </div>
  <div class="hud">
    <div class="username">{{ username }}</div>
    <div class="accuracy">
      Accuracy: {{ accuracy }}%
    </div>
    <div class="time-elapsed">
      Time: {{ timeElapsed }}s
    </div>
  </div>
</div>
